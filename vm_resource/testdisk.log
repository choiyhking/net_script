

Fri Nov 15 17:09:21 2024
Command line: TestDisk

TestDisk 7.1, Data Recovery Utility, July 2019
Christophe GRENIER <grenier@cgsecurity.org>
https://www.cgsecurity.org
OS: Linux, kernel 6.6.31+rpt-rpi-2712 (#1 SMP PREEMPT Debian 1:6.6.31-1+rpt1 (2024-05-29)) aarch64
Compiler: GCC 12.2
ext2fs lib: 1.47.0, ntfs lib: libntfs-3g, reiserfs lib: none, ewf lib: none, curses lib: ncurses 6.3
Warning: can't get size for Disk /dev/mapper/control - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop0 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop1 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop2 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop3 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop4 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop5 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop6 - 0 B - 0 sectors, sector size=512
Warning: can't get size for Disk /dev/loop7 - 0 B - 0 sectors, sector size=512
Hard disk list
Disk /dev/mmcblk0 - 64 GB / 59 GiB - CHS 1953792 4 16, sector size=512

Partition table type (auto): Intel
Disk /dev/mmcblk0 - 64 GB / 59 GiB
Partition table type: Intel

Analyse Disk /dev/mmcblk0 - 64 GB / 59 GiB - CHS 1953792 4 16
Geometry from i386 MBR: head=255 sector=63
BAD_RS LBA=8192 4096
FAT32 at 128/0/1
Info: size boot_sector 1048572, partition 1048576
FAT1 : 32-2071
FAT2 : 2072-4111
start_rootdir : 4112 root cluster : 2
Data : 4112-1048571
sectors : 1048572
cluster_size : 4
no_of_cluster : 261115 (2 - 261116)
fat_length 2040 calculated 2040
heads/cylinder 255 (FAT) != 4 (HD)
sect/track 63 (FAT) != 16 (HD)
get_geometry_from_list_part_aux head=4 nbr=4
get_geometry_from_list_part_aux head=8 nbr=4
get_geometry_from_list_part_aux head=16 nbr=4
get_geometry_from_list_part_aux head=32 nbr=4
get_geometry_from_list_part_aux head=64 nbr=4
get_geometry_from_list_part_aux head=128 nbr=4
Current partition structure:
Warning: number of heads/cylinder mismatches 255 (FAT) != 4 (HD)
Warning: number of sectors per track mismatches 63 (FAT) != 16 (HD)
 1 P FAT32 LBA              128   0  1 16511   3 16    1048576 [bootfs]

Warning: Bad ending sector (CHS and LBA don't match)
 2 P Linux                16512   0  1 1953791   3 16  123985920 [rootfs]

Warning: Bad starting sector (CHS and LBA don't match)
No partition is bootable

search_part()
Disk /dev/mmcblk0 - 64 GB / 59 GiB - CHS 1953792 4 16
FAT32 at 128/0/1
FAT1 : 32-2071
FAT2 : 2072-4111
start_rootdir : 4112 root cluster : 2
Data : 4112-1048571
sectors : 1048572
cluster_size : 4
no_of_cluster : 261115 (2 - 261116)
fat_length 2040 calculated 2040
heads/cylinder 255 (FAT) != 4 (HD)
sect/track 63 (FAT) != 16 (HD)

FAT32 at 128/0/1
FAT: cluster=2(0x2), pos=12304
FAT: cluster=430(0x1ae), pos=14016
     FAT32 LBA              128   0  1 16511   3 12    1048572 [bootfs]
     FAT32, blocksize=2048, 536 MB / 511 MiB

recover_EXT2: s_block_group_nr=0/472, s_mnt_count=9/4294967295, s_blocks_per_group=32768, s_inodes_per_group=8064
recover_EXT2: s_blocksize=4096
recover_EXT2: s_blocks_count 15498240
recover_EXT2: part_size 123985920
Filesystem created: Thu Jul  4 09:15:58 2024
Last mount time:    Wed Nov 13 16:36:43 2024
     Linux                16512   0  1 1953791   3 16  123985920 [rootfs]
     ext4 blocksize=4096 Large_file Sparse_SB Recover, 63 GB / 59 GiB
get_geometry_from_list_part_aux head=4 nbr=4
get_geometry_from_list_part_aux head=8 nbr=4
get_geometry_from_list_part_aux head=16 nbr=4
get_geometry_from_list_part_aux head=32 nbr=4
get_geometry_from_list_part_aux head=64 nbr=4
get_geometry_from_list_part_aux head=128 nbr=4
Warning: the current number of heads per cylinder is 4 but the correct value may be 128.

Results
   * FAT32 LBA              128   0  1 16511   3 16    1048576 [bootfs]
     FAT32, blocksize=2048, 536 MB / 512 MiB
   P Linux                16512   0  1 1953791   3 16  123985920 [rootfs]
     ext4 blocksize=4096 Large_file Sparse_SB Recover, 63 GB / 59 GiB

Hint for advanced users: dmsetup may be used if you prefer to avoid rewriting the partition table for the moment:
echo "0 1048576 linear /dev/mmcblk0 8192" | dmsetup create test0
echo "0 123985920 linear /dev/mmcblk0 1056768" | dmsetup create test1

interface_write()
 1 * FAT32 LBA              128   0  1 16511   3 16    1048576 [bootfs]
 2 P Linux                16512   0  1 1953791   3 16  123985920 [rootfs]
simulate write!

write_mbr_i386: starting...
write_all_log_i386: starting...
No extended partition
SIGINT detected! TestDisk has been killed.
